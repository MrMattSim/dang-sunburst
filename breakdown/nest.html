<!DOCTYPE html>
<html lang="en">
<head>
        <title>Sunburst of Nested Dimensions</title>
        <meta charset="utf-8" />

        <!--
        my CSS styles
        -->
        <link href="/dang-sunburst/theme/css/bootstrap.css"      rel="stylesheet" type="text/css">
        <link href="/dang-sunburst/theme/css/main.css"           rel="stylesheet" type="text/css">

        <link href="/dang-sunburst/theme/css/cosmo.css"          rel="stylesheet" type="text/css">
        <link href="/dang-sunburst/theme/css/font-awesome.css"   rel="stylesheet" type="text/css"/>
        <link href="/dang-sunburst/theme/css/pygment.css"        rel="stylesheet" type="text/css"/>

        <!--
        include Angular first
        -->
        <script type="text/javascript" src="/dang-sunburst/theme/js/angular-1.3.15.js"></script>
</head>

<body id="index" class="home">
    <div class="container">
        <h1><a href="/dang-sunburst/">dang-sunburst <strong></strong></a></h1>
        <hr />


<link href="/dang-sunburst/breakdown/nest.css" rel="stylesheet" stype="text/css" />

<div ng-app="nestApp">

    <div ng-controller="NestController" ng-init="initialize()">

        <div class="row">
            <div class="col-sm-12" id="sunburst_title">
                <nest-sunburst-head></nest-sunburst-head>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6" id="sunburst_chart">
                <nest-sunburst-controls></nest-sunburst-controls>
                <nest-sunburst-chart></nest-sunburst-chart>
            </div>
            <div class="col-sm-6" id="sunburst_text">
The sunburst chart on this page displays a breakdown of 
a single dimension at multiple levels.

<br />
<br />

A data set of random samples from a Weibull distribution was 
assembled. This single vector x was then binned into 
10 and 100 bins, respectively. The bins were nested,
and form the sunburst diagram to the left.

<br />
<br />

Each of the blue bars represents a partition in the inner radian, or ring,
while each of the green bars represents a partition in the outer radian, or ring.

<br />
<img src="/dang-sunburst/images/twohist.png" />
<br />

The Python code used to generate these samples is given below:

<pre>
import seaborn as sns
from numpy.random import weibull

Nsamples = 1e4

# generate a weibull distribution
k=2
x = weibull(k,(Nsamples,))

partition1, binlocs1, _ = hist(x,10);
partition2, binlocs2, _ = hist(x,100);
</pre>

These two bins still have to be turned into a nested JSON structure
to be displayed in a sunburst chart, however. Here is the code 
to parse the two vectors and construct the JSON structure:

<pre>
# Now dump this to a JSON file
import json

tree = {}
tree['name'] = 'root'
tree['freq'] = sum(partition1[:])/Nsamples

children = []
for c1 in range(len(partition1)):
    child = {}
    child['name'] = 'X%d'%(c1+1)
    child['freq'] = partition1[c1]/Nsamples

    grandchildren = []
    for c2 in range(len(partition2)):
        if c2<((c1+1)*10):
            grandchild = {}
            grandchild['name'] = 'X%d-%d'%(c1+1,c2+1)
            grandchild['freq'] = partition2[c2]/Nsamples
            grandchildren.append(grandchild)
    
    child['children'] = grandchildren
    children.append(child)

tree['children'] = children

with open('sunburst_nest_tree.json','w') as f:
    json.dump(tree,f,sort_keys=True,indent=4,separators=(',', ': '))

print "Done printing nested tree JSON to file."
</pre>

This JSON data structure is assembled and exported by Python,
and is readable as a JavaScript Object (the JSO of JSON).
The structure of JSON data required to construct a sunburst 
is given below. The frequency key "freq" is used to 
determine the size of the arcs.

<pre style="font-size: 8px;">
{
    "name": "root"
    "freq": 1.0,
    "children": [
        {
            "name": "Blue Bin 1"
            "freq": 0.1012,
            "children": [
                {
                    "freq": 0.002,
                    "name": "Blue Bin 1, Green Bin 1"
                },
                {
                    "freq": 0.0037000000000000002,
                    "name": "Blue Bin 1, Green Bin 2"
                },
                {
                    "freq": 0.0068999999999999999,
                    "name": "Blue Bin 1, Green Bin 3"
                },
                {
                    "freq": 0.0082000000000000007,
                    "name": "Blue Bin 1, Green Bin 4"
                },
                {
                    "freq": 0.0085000000000000006,
                    "name": "Blue Bin 1, Green Bin 5"
                },
                {
                    "freq": 0.011599999999999999,
                    "name": "Blue Bin 1, Green Bin 6"
                },
                {
                    "freq": 0.0143,
                    "name": "Blue Bin 1, Green Bin 7"
                },
                {
                    "freq": 0.0129,
                    "name": "Blue Bin 1, Green Bin 8"
                },
                {
                    "freq": 0.015599999999999999,
                    "name": "Blue Bin 1, Green Bin 9"
                },
                {
                    "freq": 0.017500000000000002,
                    "name": "Blue Bin 1, Green Bin 10"
                }
        }, 
        {
            "name": "Blue Bin 2"
            "freq": 0.22839999999999999,
            "children": [
                {
                    "freq": 0.015299999999999999,
                    "name": "Blue Bin 2, Green Bin 11"
                },
                {
                    "freq": 0.019699999999999999,
                    "name": "Blue Bin 2, Green Bin 12"
                },

                

                [...]


            ]
        }
}
</pre>
            </div>
        </div>

    </div>

</div>

<script type="text/javascript" src="/dang-sunburst/breakdown/nest_modcontrol.js"></script>
<script type="text/javascript" src="/dang-sunburst/breakdown/nest_sunburst.js"></script>

    </div>

    <footer id="contentinfo" class="body">
    <hr />
    <p style="text-align: center">
        <span class="fa-stack fa-lg">
            <i class="fa fa-square fa-stack-2x"></i>
            <i class="fa fa-terminal fa-stack-1x fa-inverse"></i>
        </span>
        Made from the command line with vim by 
        <a href="http://charlesreid1.com">charlesreid1</a>.
    </p>

    <p style="text-align: center;">Made with HTML (
    <a href="http://http://bootstrap.org/">Bootstrap</a>,
    <a href="http://bootswatch.com">Bootswatch</a>), 
    Javascript (
    <a href="http://http://d3js.org/">D3.js</a>, 
    <a href=https://angularjs.org/">Angular.js</a>,
    <a href="https://jquery.com/">jQuery</a>), 
    and Python (
    <a href="http://getpelican.com">Pelican</a>,
    <a href="http://http://stanford.edu/~mwaskom/software/seaborn/">Seaborn</a>,
    <a href="http://matplotlib.org">Matplotlib</a>,
    <a href="http://numpy.org">Numpy</a>).
    </p>

        <script type="text/javascript" src="/dang-sunburst/theme/js/jquery-1.11.2.js"></script>
        <script type="text/javascript" src="/dang-sunburst/theme/js/bootstrap-3.3.4.js"></script>
        <script type="text/javascript" src="/dang-sunburst/theme/js/d3-3.5.5.js"></script>
        <!--
        <script type="text/javascript" src="/dang-sunburst/theme/js/leaflet-0.7.3.js"></script>
        <script type="text/javascript" src="/dang-sunburst/theme/js/leaflet.ajax.min.js"></script>
        -->
    </footer><!-- /#contentinfo -->

</body>
</html>